# 进程和线程 #

下面是抽象类比：
单CPU：一台单核处理器计算机 = 一个车间；
多CPU：一台多核处理器计算机 = 一座工厂；

进程：一个车间 = 一个进程； （即一个运行的程序）
多进程：一座工厂可以同时运行多个车间；
CPU和进程：单CPU只能同时运行单个进程，多CPU可以同时运行多个进程。

线程：车间内一个工人 = 一个线程；
进程与线程：一个进程可以包括多个线程。

线程间内存共享：车间的空间是工人们共享的，比如许多房间是每个工人都可以进出的。
一个进程的内存空间是共享的，每个线程都可以使用这些共享内存。

内存安全：可是，每个车间容纳大小不同，有的最多只能容纳一个人。车间人满的时候，其他人就进不去了。
一个线程使用某些共享内存时，其他线程必须等它结束，才能使用这一块内存。

互斥锁：一个防止他人进入的简单方法，就是门口加一把锁。先到的人锁上门，后到的人看到上锁，就在门口排队，等锁打开再进去。
这就叫"互斥锁"–Mutex，防止两个线程同时读写某一块内存区域。

信号量：这时的解决方法，就是在门口挂n把钥匙。进去的人就取一把钥匙，出来时再把钥匙挂回原处。后到的人发现钥匙架空了，就知道必须在门口排队等着了。
这种做法叫做"信号量"（Semaphore），用来保证多个线程不会互相冲突。

锁和信号量：不难看出，互斥锁是信号量的一种特殊情况（n=1时）。也就是说，完全可以用后者替代前者。
但是，因为mutex较为简单，且效率高，所以在必须保证资源独占的情况下，还是采用这种设计。

操作系统的资源分配与调度逻辑

以多进程形式，允许多个任务同时运行；
以多线程形式，允许单个任务分成不同的部分运行；
提供协调机制，一方面防止进程之间和线程之间产生冲突，另一方面允许进程之间和线程之间共享资源。
下面是严谨的解释：
进程
进程是程序的一次执行过程，是一个动态概念，是程序在执行过程中分配和管理资源的基本单位，每一个进程都有一个自己的地址空间，
至少有 5 种基本状态，它们是：初始态，执行态，等待状态，就绪状态，终止状态。

线程
线程是CPU调度和分派的基本单位，它可与同属一个进程的其他的线程共享进程所拥有的全部资源。

进程和线程的关系
线程是进程的一部分
一个线程只能属于一个进程，而一个进程可以有多个线程，但至少有一个线程


进程和线程的区别
理解它们的差别，我从资源使用的角度出发。（所谓的资源就是计算机里的中央处理器，内存，文件，网络等等）

根本区别：进程是操作系统资源分配的基本单位，而线程是任务调度和执行的基本单位

开销方面：每个进程都有独立的代码和数据空间（程序上下文），进程之间切换开销大；
线程可以看做轻量级的进程，同一类线程共享代码和数据空间，每个线程都有自己独立的运行栈和程序计数器（PC），线程之间切换的开销小

所处环境：在操作系统中能同时运行多个进程（程序）；而在同一个进程（程序）中有多个线程同时执行（通过CPU调度，在每个时间片中只有一个线程执行）

内存分配：系统在运行的时候会为每个进程分配不同的内存空间；而对线程而言，除了CPU外，
系统不会为线程分配内存（线程所使用的资源来自其所属进程的资源），线程组之间只能共享资源

包含关系：没有线程的进程可以看做是单线程的，如果一个进程内有多个线程，则执行过程不是一条线的，
而是多条线（线程）共同完成的；线程是进程的一部分，所以线程也被称为轻权进程或者轻量级进程
